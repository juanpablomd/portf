<form
  id="contact-form"
  method="POST"
  action="https://formspree.io/f/mjkpbvba"
  class="max-w-lg mx-auto p-8 rounded-2xl shadow-2xl bg-white dark:bg-gray-800 space-y-6 transition-colors duration-500 border border-gray-200 dark:border-gray-700 text-left"
>
  <div>
    <label for="name" class="block text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300">Nombre</label>
    <input 
      type="text" 
      id="name" 
      name="name"
      placeholder="Tu nombre completo"
      required 
      class="w-full p-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 
             focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all text-gray-800 dark:text-white" 
    />
  </div>

  <div>
    <label for="email" class="block text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300">Email</label>
    <input 
      type="email" 
      id="email" 
      name="_replyto" 
      placeholder="ejemplo@correo.com"
      required 
      class="w-full p-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 
             focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all text-gray-800 dark:text-white" 
    />
  </div>

  <div>
    <label for="subject" class="block text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300">Asunto</label>
    <input 
      type="text" 
      id="subject" 
      name="_subject" 
      placeholder="Oportunidad de trabajo / Pregunta sobre proyecto"
      class="w-full p-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 
             focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all text-gray-800 dark:text-white" 
    />
  </div>

  <div>
    <label for="message" class="block text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300">Mensaje</label>
    <textarea 
      id="message" 
      name="message" 
      rows="5" 
      placeholder="Cuéntame sobre tu proyecto o consulta..."
      required 
      class="w-full p-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 
             focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none text-gray-800 dark:text-white"
    ></textarea>
  </div>

  <button
    type="submit"
    class="w-full py-3 bg-blue-600 text-white font-bold tracking-wider rounded-xl hover:bg-blue-700 transition shadow-md hover:shadow-lg"
  >
    Enviar mensaje <i class="fas fa-paper-plane ml-2"></i>
  </button>
</form>


<div 
  id="success-modal" 
  class="fixed inset-0 bg-black bg-opacity-50 items-center justify-center z-50 hidden"
>
  <div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-2xl text-center max-w-sm mx-4">
    <i class="fas fa-check-circle text-green-500 text-5xl mb-4"></i>
    <h3 class="text-2xl font-bold mb-3 text-gray-900 dark:text-white">¡Mensaje Enviado con Éxito!</h3>
    <p class="text-gray-700 dark:text-gray-300 mb-6">
      Gracias por contactarme, Juan Pablo te responderá a la brevedad posible.
    </p>
    <button 
      id="close-modal-button" 
      class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"
    >
      Cerrar
    </button>
  </div>
</div>


<script>
  // 1. Obtención de referencias
  const form = document.getElementById('contact-form') as HTMLFormElement | null; 
  const modal = document.getElementById('success-modal');
  const closeModalButton = document.getElementById('close-modal-button');

  if (form && modal && closeModalButton) {
      
    // Función para cerrar el modal: Oculta y limpia 'flex'
    const closeModal = () => {
      modal.classList.add('hidden');
      modal.classList.remove('flex'); // Limpia la clase flex al ocultar
    };

    closeModalButton.addEventListener('click', closeModal);

    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        closeModal();
      }
    });

    form.addEventListener('submit', async (e) => {
      e.preventDefault(); 
      
      const formspreeUrl = form.getAttribute('action');
      const formData = new FormData(form); 

      if (!formspreeUrl) {
          alert('Error: La URL de Formspree no se encontró en el formulario.');
          return;
      }
      
      try {
        const response = await fetch(formspreeUrl, {
          method: 'POST',
          body: formData,
          headers: {
            'Accept': 'application/json'
          }
        });

        if (response.ok) {
          form.reset(); 
          // Muestra el modal: remueve 'hidden' y AÑADE 'flex'
          modal.classList.remove('hidden'); 
          modal.classList.add('flex'); // Aplica flex para centrar
        } else {
          const data = await response.json();
          if (data.errors) {
            alert('Error en el formulario: ' + data.errors.map((err: { message: string }) => err.message).join(', '));
          } else {
            alert('Hubo un error al enviar el mensaje. Por favor, intenta de nuevo más tarde.');
          }
        }
      } catch (error) {
        console.error("Error de fetch:", error);
        alert('Error de conexión. Revisa tu internet e inténtalo de nuevo.');
      }
    });
  }
</script>




